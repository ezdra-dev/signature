<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assinatura GL ONE</title>
    <link rel="icon" type="image/svg+xml" href="/logo.svg" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <style>
      * {
        font-family: "Figtree", sans-serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        overflow: hidden;
        color: #fff;
      }
      html {
        font-size: 16px;
      }
      body {
        background: url(/banner.png) no-repeat center center;
        background-size: cover;
        width: 100vw;
        height: 100vh;
        padding: 1.25rem;
      }
      body::before {
        content: "";
        position: absolute;
        z-index: -10;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, #201f5d 65%, #0e0d5880);
      }
      header {
        display: flex;
        align-items: center;
        gap: 3.125rem;
        color: #fff;
        font-size: 0.875rem;
        font-weight: 600;
      }
      .content {
        display: flex;
        flex-direction: column;
        font-weight: 700;
        p {
          color: #a5a3ec;
          font-size: 0.875rem;
        }
        h1 {
          position: relative;
          width: fit-content;
          padding-right: 2.8125rem;
          font-size: 1.875rem;
        }

        h1::before {
          content: "";
          position: absolute;
          background-color: #0066ff;
          z-index: -10;
          bottom: 0.8125rem;
          right: 0;
          width: 1.25rem;
          height: 1.25rem;
          border-radius: 100%;
        }
      }

      main {
        display: flex;
        flex-direction: column;
        height: 90vh;
        justify-content: space-around;
        align-items: start;
        max-height: 600px;
        margin-top: 5vh;
      }
      form {
        width: 100%;
        max-width: 37.5rem;
        padding: 2.5rem 0;
        display: flex;
        flex-direction: column;
        gap: 2.1875rem;
      }

      .input-glone-container {
        position: relative;
        overflow: visible;
        width: 100%;

        p {
          color: #a5a3ec;
          font-size: 0.875rem;
          font-weight: 800;
        }
      }
      .input-glone {
        background: #181846;
        border: 0.09375rem solid #28286a;
        border-radius: 0.75rem;
        padding: 0.75rem 1.125rem;
        color: #fff;
        font-size: 0.75rem;
        outline: none;
        transition: border 0.2s;
        width: 100%;
        box-sizing: border-box;
      }
      .input-glone:focus {
        border: 0.09375rem solid #0066ff;
      }
      .input-glone + label {
        position: absolute;
        top: 30%;
        transform: translateX(-30%);
        left: 1.5625rem;
        color: #a5a3ec;
        font-size: 0.75rem;
        pointer-events: none;
        transition: 0.2s;
        background: transparent;
        z-index: 10;
      }
      .input-glone:focus + label,
      .input-glone:not(:placeholder-shown) + label {
        top: -1.375rem;
        left: 0.9375rem;
        color: #ffffff;
        background: transparent;
        font-weight: 600;
        padding: 0 0.25rem;
      }
      .hidden {
        display: none;
      }
      .toggle-button-cover {
        display: table-cell;
        position: relative;
        width: 100px;
        height: 40px;
        box-sizing: border-box;
      }

      .button-cover {
        height: 100px;
        margin: 20px;
        background-color: #fff;
        box-shadow: 0 10px 20px -8px #c5d6d6;
        border-radius: 4px;
      }

      .button-cover:before {
        counter-increment: button-counter;
        content: counter(button-counter);
        position: absolute;
        right: 0;
        bottom: 0;
        color: #d7e3e3;
        font-size: 12px;
        line-height: 1;
        padding: 5px;
      }

      .button-cover,
      .knobs,
      .layer {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      .button {
        position: relative;
        top: 50%;
        width: 74px;
        height: 36px;
        margin: -20px auto 0 auto;
        overflow: hidden;
      }

      .checkbox {
        position: relative;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        cursor: pointer;
        z-index: 3;
      }

      .knobs {
        z-index: 2;
      }

      .layer {
        width: 100%;
        background-color: #181846;
        transition: 0.3s ease all;
        border: 1px solid #28286a;
        z-index: 1;
      }

      .button.r,
      .button.r .layer {
        border-radius: 100px;
      }

      #button-3 .knobs:before {
        content: "Não";
        position: absolute;
        top: 4px;
        left: 4px;
        width: 20px;
        height: 10px;
        color: #181846;
        font-size: 10px;
        font-weight: bold;
        text-align: center;
        line-height: 1;
        padding: 9px 4px;
        background-color: #fcebeb;
        border-radius: 50%;
        transition: 0.3s ease all,
          left 0.3s cubic-bezier(0.18, 0.89, 0.35, 1.15);
      }

      #button-3 .checkbox:active + .knobs:before {
        width: 46px;
        border-radius: 100px;
      }

      #button-3 .checkbox:checked:active + .knobs:before {
        margin-left: -26px;
      }

      #button-3 .checkbox:checked + .knobs:before {
        content: "Sim";
        left: 42px;
        background-color: #fcebeb;
        color: #181846;
      }

      #button-3 .checkbox:checked ~ .layer {
        background-color: #181846;
      }

      .box-buttons {
        display: flex;
        gap: 0.625rem;
        justify-content: end;
        button {
          padding: 0.625rem 0;
          border-radius: 0.625rem;
          font-weight: 700;
          font-size: 0.8125rem;
          width: 6.25rem;
          border: none;
          display: block;
          cursor: pointer;
        }
      }

      .submit-button {
        background-color: #0066ff;
        color: #fff;
        transition: background 0.2s, color 0.2s;
      }
      .submit-button:hover {
        background-color: #0052cc;
        color: #e0e0e0;
      }

      .clear-button {
        background-color: #fff;
        color: #201f5d;
        transition: background 0.2s, color 0.2s, border 0.2s;
      }
      .clear-button:hover {
        background-color: #cfcfcf;
      }

      .clear-button:disabled {
        background-color: #e9e9e950 !important;
        color: #888 !important;
        cursor: not-allowed;
        opacity: 0.7;
        border: none;
      }
      .submit-button:disabled {
        background-color: #0052cc71 !important;
        color: #888 !important;
        cursor: not-allowed;
        opacity: 0.7;
        border: none;
      }
      #buttonLoading {
        align-items: center;
        gap: 1rem;
        justify-content: center;
      }
      #buttonLoading .fa-spinner {
        font-size: 1em;
      }
    </style>
  </head>
  <body>
    <header>
      <img src="/logo.svg" alt="logo" style="width: 40px" />
      <p>GROUP LINK ONE</p>
    </header>
    <main>
      <div class="content">
        <p>Gere sua assinatura de e-mail</p>
        <h1>Assinatura profissional GL ONE</h1>
        <div class="input-glone-container" style="display: flex; align-items: center; gap: 0.5rem; height: 53px; margin-top: 15px;">
          <label for="addCardToggle" style="color: #a5a3ec; font-size: 0.875rem; font-weight: 800; display: block;">Adicionar Cartão de Visita?</label>
          <div class="toggle-button-cover">
            <div id="button-3" class="button r">
              <input class="checkbox" type="checkbox" id="addCardToggle" name="addCard" />
              <div class="knobs"></div>
              <div class="layer"></div>
            </div>
          </div>
          <div class="hidden" id="cardUploadContainer" style="display: none; align-items: center; gap: 0.75rem;">
            <label for="cardImage" style="display: flex; align-items: center; justify-content: center; width: 3rem; height: 3rem; border-radius: 50%; background: #181846; border: 1px solid #28286a; cursor: pointer; box-shadow: 0 2px 8px #0002; transition: border 0.2s; margin-bottom: 5px;">
              <i class="fa fa-paperclip" style="font-size: 1.25rem; color: #a5a3ec;"></i>
              <input type="file" id="cardImage" name="cardImage" accept="image/*" style="display: none;" />
            </label>
          </div>
        </div>
      </div>
      <form class="form" id="signatureForm">
        <div class="input-glone-container">
          <input
            type="text"
            id="name"
            name="name"
            class="input-glone"
            placeholder=" "
            required
          />
          <label for="name">Nome</label>
        </div>
        <div class="input-glone-container">
          <input
            type="text"
            id="position"
            name="position"
            class="input-glone"
            placeholder=" "
            required
          />
          <label for="position">Cargo</label>
        </div>
        <div style="display: flex; gap: 18px; overflow: visible; width: 100%">
          <div class="input-glone-container">
            <input
              type="email"
              id="email"
              name="email"
              class="input-glone"
              placeholder=" "
              required
            />
            <label for="email">Email</label>
          </div>
          <div class="input-glone-container">
            <input
              type="tel"
              id="phone"
              name="phone"
              class="input-glone"
              placeholder=" "
              required
            />
            <label for="phone">Telefone</label>
          </div>
        </div>
        <div class="box-buttons">
          <button type="reset" class="clear-button">Limpar</button>
          <button type="submit" class="submit-button">
            <span id="buttonText"> Criar </span>
            <span id="buttonLoading" class="hidden">
              <i class="fas fa-spinner fa-spin"></i> Gerando
            </span>
          </button>
        </div>
      </form>
    </main>
  </body>
  <script>
    const form = document.getElementById("signatureForm");
    const generateBtn = document.querySelector(".submit-button");
    const clearBtn = document.querySelector(".clear-button");
    const buttonText = document.getElementById("buttonText");
    const buttonLoading = document.getElementById("buttonLoading");
    const addCardToggle = document.getElementById("addCardToggle");
    const cardUploadContainer = document.getElementById("cardUploadContainer");
    const cardImageInput = document.getElementById("cardImage");
    const cardImageLabel = cardImageInput.parentElement;
    const paperclipIcon = cardImageLabel.querySelector(".fa-paperclip");

    cardUploadContainer.style.display = "none";
    addCardToggle.checked = false;

    cardImageInput.addEventListener("change", function (e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (ev) {
          cardImageLabel.style.background = `url('${ev.target.result}') center center/cover no-repeat`;
          paperclipIcon.style.display = "none";
        };
        reader.readAsDataURL(file);
      } else {
        cardImageLabel.style.background = "#181846";
        cardImageLabel.style.border = "1px solid #28286a";
        paperclipIcon.style.display = "inline-block";
      }
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(form);

      buttonText.classList.add("hidden");
      buttonLoading.classList.remove("hidden");
      buttonLoading.style.display = "flex";
      generateBtn.disabled = true;
      clearBtn.disabled = true;

      try {
        const response = await fetch("/generate-gif", {
          method: "POST",
          body: formData,
        });

        if (!response.ok) {
          throw new Error("Erro ao gerar assinatura");
        }

        showToast("Assinatura enviada com sucesso!");
      } catch (error) {
        alert("Erro ao gerar assinatura. Tente novamente.");
      } finally {
        buttonText.classList.remove("hidden");
        buttonLoading.classList.add("hidden");
        buttonLoading.style.display = "";
        generateBtn.disabled = false;
        clearBtn.disabled = false;
      }
    });

    clearBtn.addEventListener("click", () => {
      buttonText.classList.remove("hidden");
      buttonLoading.classList.add("hidden");
      buttonLoading.style.display = "";
      generateBtn.disabled = false;
      clearBtn.disabled = false;
    });

    const phoneInput = document.getElementById("phone");

    phoneInput.addEventListener("input", function (e) {
      let value = e.target.value.replace(/\D/g, "");

      if (value.startsWith("55")) value = value.slice(2);

      if (value.length > 11) value = value.slice(0, 11);

      let masked = "+55 ";

      if (value.length > 0) {
        masked += "(" + value.substring(0, 2);
      }
      if (value.length >= 3) {
        masked +=
          ") " + value.substring(2, value.length >= 7 ? 7 : value.length);
      }
      if (value.length >= 7) {
        masked += "-" + value.substring(7, 11);
      }

      e.target.value = masked.trim();
    });

    addCardToggle.addEventListener("change", function () {
      if (this.checked) {
        cardUploadContainer.style.display = "flex";
      } else {
        cardUploadContainer.style.display = "none";
      }
    });

    function showToast(message) {
      let toast = document.createElement("div");
      toast.textContent = message;
      toast.style.position = "fixed";
      toast.style.top = "32px";
      toast.style.right = "32px";
      toast.style.left = "unset";
      toast.style.transform = "translateY(-40px) scale(0.95)";
      toast.style.background = "#181846";
      toast.style.color = "#fff";
      toast.style.padding = "12px 24px";
      toast.style.borderRadius = "0.75rem";
      toast.style.fontWeight = "bold";
      toast.style.fontSize = "0.95rem";
      toast.style.boxShadow = "0 2px 12px #0002";
      toast.style.zIndex = "9999";
      toast.style.opacity = "0";
      toast.style.border = "0.09375rem solid #28286a";
      toast.style.transition = "opacity 0.25s, transform 0.4s cubic-bezier(.4,1.3,.5,1)";
      document.body.appendChild(toast);
      setTimeout(() => {
        toast.style.opacity = "1";
        toast.style.transform = "translateY(0) scale(1)";
      }, 10);
      setTimeout(() => {
        toast.style.opacity = "0";
        toast.style.transform = "translateY(-40px) scale(0.95)";
        setTimeout(() => toast.remove(), 400);
      }, 3500);
    }
  </script>
</html>
